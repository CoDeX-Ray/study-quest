import{b as y,E as S,a as _,r as l,j as e,B,o as p,s as u}from"./index-wmXKAJ3Q.js";import{C as g}from"./card-CczKxL-i.js";import{S as R,a as C,b as E,c as A,d as m}from"./select-qtKljXUV.js";import{A as L}from"./arrow-left-XrHIZCB3.js";import{B as k}from"./bug-DKYx5UWu.js";import"./index-CJJGHSxQ.js";import"./chevron-down-BRgWjivz.js";const D=()=>{const d=y(),{toast:r}=S(),{isAdmin:i,loading:f}=_(),[o,x]=l.useState([]),[h,j]=l.useState(!0);l.useEffect(()=>{!f&&!i&&d("/dashboard")},[i,f,d]),l.useEffect(()=>{i&&(async()=>{const{data:t,error:c}=await u.from("bug_reports").select("*").order("created_at",{ascending:!1});if(c)r({title:"Error",description:"Failed to load bug reports",variant:"destructive"});else{const a=await Promise.all((t||[]).map(async n=>{if(n.user_id){const{data:w}=await u.from("profiles").select("full_name, email").eq("id",n.user_id).single();return{...n,profiles:w}}return n}));x(a)}j(!1)})()},[i,r]);const v=async(s,t)=>{const{error:c}=await u.from("bug_reports").update({status:t}).eq("id",s);c?r({title:"Error",description:"Failed to update status",variant:"destructive"}):(r({title:"Success",description:"Bug report status updated"}),x(o.map(a=>a.id===s?{...a,status:t}:a)))},b=s=>{switch(s){case"high":return"destructive";case"medium":return"default";case"low":return"secondary";default:return"default"}},N=s=>{switch(s){case"open":return"destructive";case"in_progress":return"default";case"resolved":return"secondary";default:return"default"}};return h?e.jsx("div",{className:"p-8",children:"Loading..."}):e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-destructive/5 via-background to-warning/5 p-8",children:e.jsxs("div",{className:"max-w-7xl mx-auto space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs(B,{variant:"ghost",onClick:()=>d("/admin/dashboard"),children:[e.jsx(L,{className:"h-4 w-4 mr-2"}),"Back"]}),e.jsxs("h1",{className:"text-4xl font-bold text-foreground flex items-center gap-3",children:[e.jsx(k,{className:"h-10 w-10 text-warning"}),"Bug Reports"]})]}),e.jsx("div",{className:"space-y-4",children:o.length===0?e.jsx(g,{className:"p-8 text-center border-border/50 bg-surface",children:e.jsx("p",{className:"text-muted-foreground",children:"No bug reports found"})}):o.map(s=>e.jsxs(g,{className:"p-6 border-border/50 bg-surface",children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-xl font-bold text-foreground",children:s.title}),e.jsxs("p",{className:"text-sm text-muted-foreground mt-1",children:["Reported by: ",s.profiles?.full_name||s.profiles?.email||"Unknown"]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:new Date(s.created_at).toLocaleString()})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(p,{variant:b(s.priority),children:s.priority}),e.jsx(p,{variant:N(s.status),children:s.status.replace("_"," ")})]})]}),e.jsx("p",{className:"text-foreground mb-4",children:s.description}),e.jsx("div",{className:"flex gap-2",children:e.jsxs(R,{value:s.status,onValueChange:t=>v(s.id,t),children:[e.jsx(C,{className:"w-[180px]",children:e.jsx(E,{placeholder:"Update status"})}),e.jsxs(A,{children:[e.jsx(m,{value:"open",children:"Open"}),e.jsx(m,{value:"in_progress",children:"In Progress"}),e.jsx(m,{value:"resolved",children:"Resolved"})]})]})})]},s.id))})]})})};export{D as default};
