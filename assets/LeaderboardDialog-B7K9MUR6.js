import{c as U,q as Q,r as o,j as e,l as Z,P as R,t as P,v as _,m as C,u as ee,a as ae,s as te,B as re,n as T}from"./index-BC4Bl_DL.js";import{D as se,b as ne,c as oe,d as le,e as ie}from"./dialog-DkqcDn-U.js";import{T as ce,a as de,b as A,c as L}from"./tabs-DP0unkL4.js";import{T as q}from"./trophy-KGWIW8jd.js";import{A as ue}from"./award-KPrSWlo0.js";const fe=U("Medal",[["path",{d:"M7.21 15 2.66 7.14a2 2 0 0 1 .13-2.2L4.4 2.8A2 2 0 0 1 6 2h12a2 2 0 0 1 1.6.8l1.6 2.14a2 2 0 0 1 .14 2.2L16.79 15",key:"143lza"}],["path",{d:"M11 12 5.12 2.2",key:"qhuxz6"}],["path",{d:"m13 12 5.88-9.8",key:"hbye0f"}],["path",{d:"M8 7h8",key:"i86dvs"}],["circle",{cx:"12",cy:"17",r:"5",key:"qbz8iq"}],["path",{d:"M12 18v-2h-.5",key:"fawc4q"}]]);const Le=U("Star",[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]]);var E={exports:{}},k={};var M;function me(){if(M)return k;M=1;var a=Q();function t(n,i){return n===i&&(n!==0||1/n===1/i)||n!==n&&i!==i}var s=typeof Object.is=="function"?Object.is:t,l=a.useState,u=a.useEffect,r=a.useLayoutEffect,h=a.useDebugValue;function f(n,i){var g=i(),S=l({inst:{value:g,getSnapshot:i}}),x=S[0].inst,y=S[1];return r(function(){x.value=g,x.getSnapshot=i,m(x)&&y({inst:x})},[n,g,i]),u(function(){return m(x)&&y({inst:x}),n(function(){m(x)&&y({inst:x})})},[n]),h(g),g}function m(n){var i=n.getSnapshot;n=n.value;try{var g=i();return!s(n,g)}catch{return!0}}function v(n,i){return i()}var p=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?v:f;return k.useSyncExternalStore=a.useSyncExternalStore!==void 0?a.useSyncExternalStore:p,k}var D;function xe(){return D||(D=1,E.exports=me()),E.exports}var he=xe();function ve(){return he.useSyncExternalStore(ge,()=>!0,()=>!1)}function ge(){return()=>{}}var I="Avatar",[pe]=Z(I),[Se,$]=pe(I),z=o.forwardRef((a,t)=>{const{__scopeAvatar:s,...l}=a,[u,r]=o.useState("idle");return e.jsx(Se,{scope:s,imageLoadingStatus:u,onImageLoadingStatusChange:r,children:e.jsx(R.span,{...l,ref:t})})});z.displayName=I;var B="AvatarImage",V=o.forwardRef((a,t)=>{const{__scopeAvatar:s,src:l,onLoadingStatusChange:u=()=>{},...r}=a,h=$(B,s),f=ye(l,r),m=P(v=>{u(v),h.onImageLoadingStatusChange(v)});return _(()=>{f!=="idle"&&m(f)},[f,m]),f==="loaded"?e.jsx(R.img,{...r,ref:t,src:l}):null});V.displayName=B;var H="AvatarFallback",O=o.forwardRef((a,t)=>{const{__scopeAvatar:s,delayMs:l,...u}=a,r=$(H,s),[h,f]=o.useState(l===void 0);return o.useEffect(()=>{if(l!==void 0){const m=window.setTimeout(()=>f(!0),l);return()=>window.clearTimeout(m)}},[l]),h&&r.imageLoadingStatus!=="loaded"?e.jsx(R.span,{...u,ref:t}):null});O.displayName=H;function F(a,t){return a?t?(a.src!==t&&(a.src=t),a.complete&&a.naturalWidth>0?"loaded":"loading"):"error":"idle"}function ye(a,{referrerPolicy:t,crossOrigin:s}){const l=ve(),u=o.useRef(null),r=l?(u.current||(u.current=new window.Image),u.current):null,[h,f]=o.useState(()=>F(r,a));return _(()=>{f(F(r,a))},[r,a]),_(()=>{const m=n=>()=>{f(n)};if(!r)return;const v=m("loaded"),p=m("error");return r.addEventListener("load",v),r.addEventListener("error",p),t&&(r.referrerPolicy=t),typeof s=="string"&&(r.crossOrigin=s),()=>{r.removeEventListener("load",v),r.removeEventListener("error",p)}},[r,s,t]),h}var G=z,K=V,W=O;const X=o.forwardRef(({className:a,...t},s)=>e.jsx(G,{ref:s,className:C("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",a),...t}));X.displayName=G.displayName;const Y=o.forwardRef(({className:a,...t},s)=>e.jsx(K,{ref:s,className:C("aspect-square h-full w-full",a),...t}));Y.displayName=K.displayName;const J=o.forwardRef(({className:a,...t},s)=>e.jsx(W,{ref:s,className:C("flex h-full w-full items-center justify-center rounded-full bg-muted",a),...t}));J.displayName=W.displayName;const Ee=()=>{const{user:a}=ee(),{isAdmin:t}=ae(),[s,l]=o.useState(!1),[u,r]=o.useState([]),[h,f]=o.useState([]),[m,v]=o.useState([]),[p,n]=o.useState(!1),[i,g]=o.useState("all");o.useEffect(()=>{s&&S()},[s,i]);const S=async()=>{n(!0);try{let d=te.from("profiles").select("id, full_name, avatar_url, xp, level, role, current_streak").order("xp",{ascending:!1}).limit(100);const{data:c,error:j}=await d;if(j)throw j;if(c){const w=t?c:c.filter(b=>b.role!=="admin");r(w),f(w.filter(b=>b.role==="student")),v(w.filter(b=>b.role==="professional"))}}catch(d){console.error("Error fetching leaderboard:",d)}finally{n(!1)}},x=d=>d===0?e.jsx(q,{className:"h-5 w-5 text-yellow-500"}):d===1?e.jsx(fe,{className:"h-5 w-5 text-gray-400"}):d===2?e.jsx(ue,{className:"h-5 w-5 text-amber-600"}):e.jsx("span",{className:"text-sm font-bold text-muted-foreground w-5",children:d+1}),y=d=>d===0?"bg-yellow-500/10 border-yellow-500/50":d===1?"bg-gray-400/10 border-gray-400/50":d===2?"bg-amber-600/10 border-amber-600/50":"bg-card border-border",N=d=>p?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"Loading..."}):d.length===0?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"No users found"}):e.jsx("div",{className:"space-y-2 overflow-y-auto max-h-[55vh] pr-3",children:d.map((c,j)=>e.jsx("div",{className:`flex items-center gap-4 p-3 rounded-lg border transition-colors ${a?.id===c.id?"bg-game-green/10 border-game-green/50":y(j)}`,children:e.jsxs("div",{className:"flex items-center gap-3 flex-1 min-w-0",children:[e.jsx("div",{className:"flex-shrink-0",children:x(j)}),e.jsxs(X,{className:"h-10 w-10",children:[e.jsx(Y,{src:c.avatar_url||void 0}),e.jsx(J,{children:c.full_name?.charAt(0)||"U"})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("p",{className:"font-semibold truncate",children:c.full_name||"Anonymous"}),a?.id===c.id&&e.jsx(T,{variant:"outline",className:"text-xs",children:"You"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[e.jsx(T,{variant:"secondary",className:"text-xs",children:c.role}),e.jsxs("span",{children:["Level ",c.level]}),c.current_streak&&c.current_streak>0&&e.jsxs("span",{className:"flex items-center gap-1",children:["ðŸ”¥ ",c.current_streak]})]})]}),e.jsxs("div",{className:"text-right flex-shrink-0",children:[e.jsx("p",{className:"font-bold text-game-green",children:c.xp.toLocaleString()}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"XP"})]})]})},c.id))});return e.jsxs(e.Fragment,{children:[e.jsx(re,{variant:"ghost",size:"icon",onClick:()=>l(!0),className:"hidden",id:"leaderboard-trigger"}),e.jsx(se,{open:s,onOpenChange:l,children:e.jsxs(ne,{className:"sm:max-w-[600px]",children:[e.jsxs(oe,{children:[e.jsxs(le,{className:"flex items-center gap-2",children:[e.jsx(q,{className:"h-5 w-5 text-yellow-500"}),"Leaderboard"]}),e.jsx(ie,{children:"See how you rank against other learners"})]}),e.jsxs(ce,{value:i,onValueChange:g,className:"w-full",children:[e.jsxs(de,{className:"grid w-full grid-cols-3",children:[e.jsx(A,{value:"all",children:"All"}),e.jsx(A,{value:"students",children:"Students"}),e.jsx(A,{value:"professionals",children:"Professionals"})]}),e.jsx(L,{value:"all",className:"mt-4",children:N(u)}),e.jsx(L,{value:"students",className:"mt-4",children:N(h)}),e.jsx(L,{value:"professionals",className:"mt-4",children:N(m)})]})]})})]})};export{X as A,Ee as L,Le as S,Y as a,J as b};
