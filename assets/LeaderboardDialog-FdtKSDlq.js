import{c as E,q as Y,r as o,j as e,m as J,P as _,t as Q,v as k,n as R,u as Z,s as P,B as ee,o as I}from"./index-C1c4C3LX.js";import{D as ae,b as te,c as re,d as se,e as ne}from"./dialog-nCFb01_0.js";import{T as oe,a as le,b as N,c as w}from"./tabs-CRvTUcxZ.js";import{T}from"./trophy-Df0xuwHZ.js";import{A as ce}from"./award-Cg_jRz9j.js";const ie=E("Medal",[["path",{d:"M7.21 15 2.66 7.14a2 2 0 0 1 .13-2.2L4.4 2.8A2 2 0 0 1 6 2h12a2 2 0 0 1 1.6.8l1.6 2.14a2 2 0 0 1 .14 2.2L16.79 15",key:"143lza"}],["path",{d:"M11 12 5.12 2.2",key:"qhuxz6"}],["path",{d:"m13 12 5.88-9.8",key:"hbye0f"}],["path",{d:"M8 7h8",key:"i86dvs"}],["circle",{cx:"12",cy:"17",r:"5",key:"qbz8iq"}],["path",{d:"M12 18v-2h-.5",key:"fawc4q"}]]);const Ne=E("Star",[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]]);const we=E("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);var L={exports:{}},A={};var q;function de(){if(q)return A;q=1;var a=Y();function t(n,i){return n===i&&(n!==0||1/n===1/i)||n!==n&&i!==i}var s=typeof Object.is=="function"?Object.is:t,c=a.useState,u=a.useEffect,r=a.useLayoutEffect,h=a.useDebugValue;function f(n,i){var g=i(),S=c({inst:{value:g,getSnapshot:i}}),x=S[0].inst,y=S[1];return r(function(){x.value=g,x.getSnapshot=i,m(x)&&y({inst:x})},[n,g,i]),u(function(){return m(x)&&y({inst:x}),n(function(){m(x)&&y({inst:x})})},[n]),h(g),g}function m(n){var i=n.getSnapshot;n=n.value;try{var g=i();return!s(n,g)}catch{return!0}}function v(n,i){return i()}var p=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?v:f;return A.useSyncExternalStore=a.useSyncExternalStore!==void 0?a.useSyncExternalStore:p,A}var M;function ue(){return M||(M=1,L.exports=de()),L.exports}var fe=ue();function me(){return fe.useSyncExternalStore(xe,()=>!0,()=>!1)}function xe(){return()=>{}}var C="Avatar",[he]=J(C),[ve,U]=he(C),F=o.forwardRef((a,t)=>{const{__scopeAvatar:s,...c}=a,[u,r]=o.useState("idle");return e.jsx(ve,{scope:s,imageLoadingStatus:u,onImageLoadingStatusChange:r,children:e.jsx(_.span,{...c,ref:t})})});F.displayName=C;var $="AvatarImage",z=o.forwardRef((a,t)=>{const{__scopeAvatar:s,src:c,onLoadingStatusChange:u=()=>{},...r}=a,h=U($,s),f=ge(c,r),m=Q(v=>{u(v),h.onImageLoadingStatusChange(v)});return k(()=>{f!=="idle"&&m(f)},[f,m]),f==="loaded"?e.jsx(_.img,{...r,ref:t,src:c}):null});z.displayName=$;var B="AvatarFallback",H=o.forwardRef((a,t)=>{const{__scopeAvatar:s,delayMs:c,...u}=a,r=U(B,s),[h,f]=o.useState(c===void 0);return o.useEffect(()=>{if(c!==void 0){const m=window.setTimeout(()=>f(!0),c);return()=>window.clearTimeout(m)}},[c]),h&&r.imageLoadingStatus!=="loaded"?e.jsx(_.span,{...u,ref:t}):null});H.displayName=B;function D(a,t){return a?t?(a.src!==t&&(a.src=t),a.complete&&a.naturalWidth>0?"loaded":"loading"):"error":"idle"}function ge(a,{referrerPolicy:t,crossOrigin:s}){const c=me(),u=o.useRef(null),r=c?(u.current||(u.current=new window.Image),u.current):null,[h,f]=o.useState(()=>D(r,a));return k(()=>{f(D(r,a))},[r,a]),k(()=>{const m=n=>()=>{f(n)};if(!r)return;const v=m("loaded"),p=m("error");return r.addEventListener("load",v),r.addEventListener("error",p),t&&(r.referrerPolicy=t),typeof s=="string"&&(r.crossOrigin=s),()=>{r.removeEventListener("load",v),r.removeEventListener("error",p)}},[r,s,t]),h}var V=F,O=z,G=H;const K=o.forwardRef(({className:a,...t},s)=>e.jsx(V,{ref:s,className:R("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",a),...t}));K.displayName=V.displayName;const W=o.forwardRef(({className:a,...t},s)=>e.jsx(O,{ref:s,className:R("aspect-square h-full w-full",a),...t}));W.displayName=O.displayName;const X=o.forwardRef(({className:a,...t},s)=>e.jsx(G,{ref:s,className:R("flex h-full w-full items-center justify-center rounded-full bg-muted",a),...t}));X.displayName=G.displayName;const Le=()=>{const{user:a}=Z(),[t,s]=o.useState(!1),[c,u]=o.useState([]),[r,h]=o.useState([]),[f,m]=o.useState([]),[v,p]=o.useState(!1),[n,i]=o.useState("all");o.useEffect(()=>{t&&g()},[t,n]);const g=async()=>{p(!0);try{let d=P.from("profiles").select("id, full_name, avatar_url, xp, level, role, current_streak").order("xp",{ascending:!1}).limit(100);const{data:l,error:j}=await d;if(j)throw j;l&&(u(l),h(l.filter(b=>b.role==="student")),m(l.filter(b=>b.role==="professional")))}catch(d){console.error("Error fetching leaderboard:",d)}finally{p(!1)}},S=d=>d===0?e.jsx(T,{className:"h-5 w-5 text-yellow-500"}):d===1?e.jsx(ie,{className:"h-5 w-5 text-gray-400"}):d===2?e.jsx(ce,{className:"h-5 w-5 text-amber-600"}):e.jsx("span",{className:"text-sm font-bold text-muted-foreground w-5",children:d+1}),x=d=>d===0?"bg-yellow-500/10 border-yellow-500/50":d===1?"bg-gray-400/10 border-gray-400/50":d===2?"bg-amber-600/10 border-amber-600/50":"bg-card border-border",y=d=>v?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"Loading..."}):d.length===0?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"No users found"}):e.jsx("div",{className:"space-y-2 max-h-[500px] overflow-y-auto",children:d.map((l,j)=>e.jsx("div",{className:`flex items-center gap-4 p-3 rounded-lg border transition-colors ${a?.id===l.id?"bg-game-green/10 border-game-green/50":x(j)}`,children:e.jsxs("div",{className:"flex items-center gap-3 flex-1 min-w-0",children:[e.jsx("div",{className:"flex-shrink-0",children:S(j)}),e.jsxs(K,{className:"h-10 w-10",children:[e.jsx(W,{src:l.avatar_url||void 0}),e.jsx(X,{children:l.full_name?.charAt(0)||"U"})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("p",{className:"font-semibold truncate",children:l.full_name||"Anonymous"}),a?.id===l.id&&e.jsx(I,{variant:"outline",className:"text-xs",children:"You"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[e.jsx(I,{variant:"secondary",className:"text-xs",children:l.role}),e.jsxs("span",{children:["Level ",l.level]}),l.current_streak&&l.current_streak>0&&e.jsxs("span",{className:"flex items-center gap-1",children:["ðŸ”¥ ",l.current_streak]})]})]}),e.jsxs("div",{className:"text-right flex-shrink-0",children:[e.jsx("p",{className:"font-bold text-game-green",children:l.xp.toLocaleString()}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"XP"})]})]})},l.id))});return e.jsxs(e.Fragment,{children:[e.jsx(ee,{variant:"ghost",size:"icon",onClick:()=>s(!0),className:"hidden",id:"leaderboard-trigger"}),e.jsx(ae,{open:t,onOpenChange:s,children:e.jsxs(te,{className:"sm:max-w-[600px] max-h-[80vh]",children:[e.jsxs(re,{children:[e.jsxs(se,{className:"flex items-center gap-2",children:[e.jsx(T,{className:"h-5 w-5 text-yellow-500"}),"Leaderboard"]}),e.jsx(ne,{children:"See how you rank against other learners"})]}),e.jsxs(oe,{value:n,onValueChange:i,className:"w-full",children:[e.jsxs(le,{className:"grid w-full grid-cols-3",children:[e.jsx(N,{value:"all",children:"All"}),e.jsx(N,{value:"students",children:"Students"}),e.jsx(N,{value:"professionals",children:"Professionals"})]}),e.jsx(w,{value:"all",className:"mt-4",children:y(c)}),e.jsx(w,{value:"students",className:"mt-4",children:y(r)}),e.jsx(w,{value:"professionals",className:"mt-4",children:y(f)})]})]})})]})};export{K as A,Le as L,Ne as S,we as U,W as a,X as b};
