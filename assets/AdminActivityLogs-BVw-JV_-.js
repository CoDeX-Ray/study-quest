import{b as v,E as y,a as N,r,j as t,B as _,s as p}from"./index-wmXKAJ3Q.js";import{C as u}from"./card-CczKxL-i.js";import{A as b}from"./arrow-left-XrHIZCB3.js";import{A as $}from"./activity-CfmS3bP4.js";const A=()=>{const o=v(),{toast:c}=y(),{isAdmin:n,loading:l}=N(),[m,f]=r.useState([]),[x,h]=r.useState(!0);return r.useEffect(()=>{!l&&!n&&o("/dashboard")},[n,l,o]),r.useEffect(()=>{n&&(async()=>{const{data:a,error:i}=await p.from("activity_logs").select("*").order("created_at",{ascending:!1}).limit(100);if(i)c({title:"Error",description:"Failed to load activity logs",variant:"destructive"});else{const s=await Promise.all((a||[]).map(async d=>{if(d.user_id){const{data:j}=await p.from("profiles").select("full_name, email").eq("id",d.user_id).single();return{...d,profiles:j}}return d}));f(s)}h(!1)})()},[n,c]),x?t.jsx("div",{className:"p-8",children:"Loading..."}):t.jsx("div",{className:"min-h-screen bg-gradient-to-br from-destructive/5 via-background to-warning/5 p-8",children:t.jsxs("div",{className:"max-w-7xl mx-auto space-y-6",children:[t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsxs(_,{variant:"ghost",onClick:()=>o("/admin/dashboard"),children:[t.jsx(b,{className:"h-4 w-4 mr-2"}),"Back"]}),t.jsxs("h1",{className:"text-4xl font-bold text-foreground flex items-center gap-3",children:[t.jsx($,{className:"h-10 w-10 text-accent"}),"Activity Logs"]})]}),t.jsx("div",{className:"space-y-4",children:m.length===0?t.jsx(u,{className:"p-8 text-center border-border/50 bg-surface",children:t.jsx("p",{className:"text-muted-foreground",children:"No activity logs found"})}):m.map(e=>{const a=e.profiles?.full_name||e.profiles?.email||"Unknown";let i="";if(e.action==="Posted content in Community"&&e.details){const s=e.details;i=`${a} posted content: "${s.post_title||"Untitled"}" (${s.post_type||"post"})`,s.content_preview&&(i+=` - ${s.content_preview}`)}else if(e.action==="Liked post in Community"&&e.details){const s=e.details;i=`${a} liked post: "${s.post_title||"Untitled"}"`}else if(e.action==="Unliked post in Community"&&e.details){const s=e.details;i=`${a} unliked post: "${s.post_title||"Untitled"}"`}else if(e.action==="Commented on post in Community"&&e.details){const s=e.details;i=`${a} commented on post: "${s.post_title||"Untitled"}"`,s.comment_preview&&(i+=` - "${s.comment_preview}"`)}else if(e.action==="Shared post in Community"&&e.details){const s=e.details;i=`${a} shared post: "${s.post_title||"Untitled"}"`}else if(e.action==="Deleted post in Community"&&e.details){const s=e.details;i=`${a} deleted post: "${s.post_title||"Untitled"}"`}else e.action==="Signed in"?i=`${a} signed in`:e.action==="Signed out"?i=`${a} signed out`:i=`${a}: ${e.action}`;return t.jsx(u,{className:"p-4 border-border/50 bg-surface",children:t.jsxs("div",{className:"flex justify-between items-start",children:[t.jsxs("div",{className:"flex-1",children:[t.jsx("p",{className:"font-semibold text-foreground",children:i}),e.details&&t.jsxs("div",{className:"mt-2 space-y-1",children:[e.details.post_id&&t.jsxs("p",{className:"text-xs text-muted-foreground",children:["Post ID: ",e.details.post_id]}),e.action==="Posted content in Community"&&t.jsxs(t.Fragment,{children:[e.details.category&&t.jsxs("p",{className:"text-xs text-muted-foreground",children:["Category: ",e.details.category]}),e.details.subject&&t.jsxs("p",{className:"text-xs text-muted-foreground",children:["Subject: ",e.details.subject]})]}),e.action==="Shared post in Community"&&e.details.share_url&&t.jsxs("p",{className:"text-xs text-muted-foreground break-all",children:["Share URL: ",e.details.share_url]})]})]}),t.jsx("p",{className:"text-sm text-muted-foreground whitespace-nowrap ml-4",children:new Date(e.created_at).toLocaleString()})]})},e.id)})})]})})};export{A as default};
