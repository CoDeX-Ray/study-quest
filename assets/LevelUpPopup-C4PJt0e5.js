import{s as d,j as e,n as m,Z as o}from"./index-DF__VrnZ.js";import{D as x,b as h,c as u,d as f}from"./dialog-kp3aK5uw.js";import{C as g}from"./card-3qKt7bUL.js";import{T as N}from"./trophy-2nWDfbvz.js";import{A as b}from"./award-CwcFnh20.js";const _=async(r,a,n)=>{const i=[];try{const{data:c}=await d.from("achievements").select("*").order("xp_required");if(!c)return i;const{data:s}=await d.from("user_achievements").select("achievement_id").eq("user_id",r),p=new Set(s?.map(t=>t.achievement_id)||[]);for(const t of c){if(p.has(t.id))continue;let l=!1;if(t.xp_required>0?a>=t.xp_required&&(l=!0):n!==void 0&&(t.name==="First Share"&&n>=1||t.name==="Community Helper"&&n>=10)&&(l=!0),l){const{error:j}=await d.from("user_achievements").insert({user_id:r,achievement_id:t.id});j||i.push(t.id)}}}catch(c){console.error("Error checking achievements:",c)}return i},C=async r=>{const{data:a}=await d.from("achievements").select("*").eq("id",r).single();return a||null},U=({achievement:r,open:a,onOpenChange:n})=>r?e.jsx(x,{open:a,onOpenChange:n,children:e.jsxs(h,{className:"max-w-md",children:[e.jsx(u,{children:e.jsx(f,{className:"text-center",children:"Achievement Unlocked!"})}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsx("div",{className:"flex justify-center",children:e.jsxs(g,{className:"p-8 bg-gradient-card border-game-green border-2",children:[e.jsx("div",{className:"text-6xl mb-4 text-center",children:r.icon}),e.jsx("h3",{className:"text-2xl font-bold text-center mb-2",children:r.name}),e.jsx("p",{className:"text-center text-muted-foreground mb-4",children:r.description}),e.jsx("div",{className:"flex justify-center",children:e.jsxs(m,{className:"bg-game-green",children:[e.jsx(N,{className:"w-4 h-4 mr-1"}),"Unlocked!"]})})]})}),e.jsx("p",{className:"text-sm text-center text-muted-foreground",children:"Congratulations! You've earned this achievement."})]})]})}):null,q=({newLevel:r,open:a,onOpenChange:n})=>{const i=s=>s>=1&&s<=5?"Novice":s>=6&&s<=10?"Apprentice":s>=11&&s<=20?"Expert":s>=21?"Master":"Novice",c=s=>s>=1&&s<=5?"bg-gray-500":s>=6&&s<=10?"bg-blue-500":s>=11&&s<=20?"bg-purple-500":s>=21?"bg-game-green":"bg-gray-500";return e.jsx(x,{open:a,onOpenChange:n,children:e.jsxs(h,{className:"max-w-md",children:[e.jsx(u,{children:e.jsx(f,{className:"text-center",children:"Level Up!"})}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsx("div",{className:"flex justify-center",children:e.jsxs(g,{className:"p-8 bg-gradient-card border-level-gold border-2",children:[e.jsx("div",{className:"flex justify-center mb-4",children:e.jsxs("div",{className:"relative",children:[e.jsx(o,{className:"h-16 w-16 text-level-gold animate-pulse",fill:"currentColor"}),e.jsx("div",{className:"absolute inset-0 h-16 w-16 text-level-gold opacity-50 animate-ping",children:e.jsx(o,{className:"h-16 w-16",fill:"currentColor"})})]})}),e.jsxs("h3",{className:"text-3xl font-bold text-center mb-2",children:["Level ",r]}),e.jsx("div",{className:"flex justify-center mb-4",children:e.jsxs(m,{className:`${c(r)} text-white`,children:[e.jsx(b,{className:"w-4 h-4 mr-1"}),i(r)]})}),e.jsx("p",{className:"text-center text-muted-foreground",children:"Congratulations! You've reached a new level!"})]})}),e.jsx("p",{className:"text-sm text-center text-muted-foreground",children:"Keep learning and sharing to level up even more!"})]})]})})};export{U as A,q as L,_ as c,C as g};
