import{c as A,b as L,u as C,r,s as o,j as e,o as t,B}from"./index-D18IeBBa.js";import{D as q,b as E,c as S,d as D}from"./dialog-Qmkc2RPf.js";import{C as d}from"./card-CrKCgtvU.js";import{X as U}from"./XPBar-BNHWVvcT.js";import{g as j,a as b,b as $,c as M}from"./profileStyles-BlV3Skav.js";import{T as X}from"./trophy-GX3dSoHg.js";import{A as R}from"./award-DyiYn1eG.js";const T=A("ExternalLink",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]),K=({userId:l,open:c,onOpenChange:m})=>{const x=L(),{user:h,loading:p}=C(),[s,N]=r.useState(null),[n,y]=r.useState([]),[f,w]=r.useState([]),[_,g]=r.useState(!1),v=r.useCallback(async()=>{if(!l)return;g(!0);const{data:a}=await o.from("profiles").select("*").eq("id",l).single();a&&N(a),g(!1)},[l]),u=r.useCallback(async()=>{if(!l)return;const{data:a}=await o.from("achievements").select("*").order("xp_required"),{data:i}=await o.from("user_achievements").select("achievement_id").eq("user_id",l);a&&y(a),i&&w(i.map(P=>P.achievement_id))},[l]);r.useEffect(()=>{c&&l&&(v(),u())},[c,l,v,u]);const k=()=>{l&&(m(!1),x(`/profile/${l}`))};return l?e.jsx(q,{open:c,onOpenChange:m,children:e.jsxs(E,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsx(S,{children:e.jsx(D,{children:"User Profile"})}),p||_?e.jsx("div",{className:"flex items-center justify-center py-8",children:"Loading..."}):s?e.jsxs("div",{className:"space-y-6",children:[e.jsx(d,{className:`p-6 bg-gradient-card ${s.border_style==="rainbow"?"":b(s.border_style)}`,style:s.border_style==="rainbow"?{}:j(s.border_style),children:e.jsxs("div",{className:"flex flex-col md:flex-row items-center gap-6",children:[e.jsx("div",{className:$(s.border_style),children:e.jsx("div",{className:`w-20 h-20 rounded-full bg-game-green/20 flex items-center justify-center text-3xl ${s.border_style==="rainbow"?"":b(s.border_style)}`,style:s.border_style==="rainbow"?{}:j(s.border_style),children:s.full_name?.[0]||"?"})}),e.jsxs("div",{className:"flex-1 text-center md:text-left",children:[e.jsx("h2",{className:`text-2xl font-bold mb-2 ${M(s.name_color)}`,children:s.full_name}),e.jsxs("div",{className:"flex items-center gap-2 justify-center md:justify-start mb-4",children:[e.jsx(t,{variant:"secondary",children:s.role}),e.jsxs(t,{variant:"outline",className:"border-level-gold/50 text-level-gold",children:["Level ",s.level]})]}),e.jsx(U,{currentXP:s.xp,maxXP:s.level*100,level:s.level})]})]})}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h3",{className:"text-lg font-semibold flex items-center gap-2",children:[e.jsx(X,{className:"w-5 h-5"}),"Achievements"]}),e.jsxs(t,{variant:"outline",children:[f.length," / ",n.length," Unlocked"]})]}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3",children:n.slice(0,6).map(a=>{const i=f.includes(a.id);return e.jsxs(d,{className:`p-4 ${i?"bg-gradient-card border-game-green":"bg-surface opacity-60"}`,children:[e.jsx("div",{className:"text-3xl mb-2",children:a.icon}),e.jsx("h4",{className:"font-semibold text-sm mb-1",children:a.name}),i&&e.jsx(t,{className:"bg-game-green text-xs",children:"Unlocked"})]},a.id)})}),n.length>6&&e.jsxs("p",{className:"text-sm text-muted-foreground mt-2 text-center",children:["+",n.length-6," more achievements"]})]}),e.jsxs(d,{className:"p-4 bg-surface",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx(R,{className:"w-5 h-5 text-level-gold"}),e.jsx("h3",{className:"font-semibold",children:"Current Rank"})]}),e.jsxs("div",{className:"space-y-2",children:[s.level>=1&&s.level<=5&&e.jsx(t,{children:"Novice (Level 1-5)"}),s.level>=6&&s.level<=10&&e.jsx(t,{className:"bg-blue-500",children:"Apprentice (Level 6-10)"}),s.level>=11&&s.level<=20&&e.jsx(t,{className:"bg-purple-500",children:"Expert (Level 11-20)"}),s.level>=21&&e.jsx(t,{className:"bg-game-green",children:"Master (Level 21+)"})]})]}),e.jsxs(B,{onClick:()=>{if(!h){x("/auth");return}k()},className:"w-full bg-game-green hover:bg-game-green-dark",children:[e.jsx(T,{className:"w-4 h-4 mr-2"}),h?"View Full Profile":"Sign in to view full profile"]})]}):e.jsx("div",{className:"flex items-center justify-center py-8 text-muted-foreground",children:"Profile not found"})]})}):null};export{K as P};
