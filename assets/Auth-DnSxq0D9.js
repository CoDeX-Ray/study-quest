import{r as t,F as k,G as W,y as Q,j as e,m as G,R as X,P as b,x as C,I as Z,z as N,H as ee,A as se,n as F,J as ae,b as re,E as oe,K as te,B as _,s as j}from"./index-wmXKAJ3Q.js";import{I as R}from"./input-ChrmIPit.js";import{L as y}from"./label-C2Fi2k85.js";import{C as ne}from"./card-CczKxL-i.js";import{T as ie,a as de,b as P,c as A}from"./tabs-BzSC16dQ.js";import{u as ce}from"./index-CJJGHSxQ.js";var I="Radio",[le,D]=G(I),[ue,pe]=le(I),T=t.forwardRef((o,n)=>{const{__scopeRadio:s,name:c,checked:r=!1,required:i,disabled:d,value:u="on",onCheck:p,form:g,...m}=o,[f,x]=t.useState(null),l=C(n,h=>x(h)),a=t.useRef(!1),v=f?g||!!f.closest("form"):!0;return e.jsxs(ue,{scope:s,checked:r,disabled:d,children:[e.jsx(b.button,{type:"button",role:"radio","aria-checked":r,"data-state":O(r),"data-disabled":d?"":void 0,disabled:d,value:u,...m,ref:l,onClick:N(o.onClick,h=>{r||p?.(),v&&(a.current=h.isPropagationStopped(),a.current||h.stopPropagation())})}),v&&e.jsx(M,{control:f,bubbles:!a.current,name:c,value:u,checked:r,required:i,disabled:d,form:g,style:{transform:"translateX(-100%)"}})]})});T.displayName=I;var L="RadioIndicator",q=t.forwardRef((o,n)=>{const{__scopeRadio:s,forceMount:c,...r}=o,i=pe(L,s);return e.jsx(ee,{present:c||i.checked,children:e.jsx(b.span,{"data-state":O(i.checked),"data-disabled":i.disabled?"":void 0,...r,ref:n})})});q.displayName=L;var me="RadioBubbleInput",M=t.forwardRef(({__scopeRadio:o,control:n,checked:s,bubbles:c=!0,...r},i)=>{const d=t.useRef(null),u=C(d,i),p=ce(s),g=se(n);return t.useEffect(()=>{const m=d.current;if(!m)return;const f=window.HTMLInputElement.prototype,l=Object.getOwnPropertyDescriptor(f,"checked").set;if(p!==s&&l){const a=new Event("click",{bubbles:c});l.call(m,s),m.dispatchEvent(a)}},[p,s,c]),e.jsx(b.input,{type:"radio","aria-hidden":!0,defaultChecked:s,...r,tabIndex:-1,ref:u,style:{...r.style,...g,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});M.displayName=me;function O(o){return o?"checked":"unchecked"}var fe=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],w="RadioGroup",[ve]=G(w,[k,D]),U=k(),B=D(),[he,ge]=ve(w),V=t.forwardRef((o,n)=>{const{__scopeRadioGroup:s,name:c,defaultValue:r,value:i,required:d=!1,disabled:u=!1,orientation:p,dir:g,loop:m=!0,onValueChange:f,...x}=o,l=U(s),a=W(g),[v,h]=Q({prop:i,defaultProp:r??null,onChange:f,caller:w});return e.jsx(he,{scope:s,name:c,required:d,disabled:u,value:v,onValueChange:h,children:e.jsx(X,{asChild:!0,...l,orientation:p,dir:a,loop:m,children:e.jsx(b.div,{role:"radiogroup","aria-required":d,"aria-orientation":p,"data-disabled":u?"":void 0,dir:a,...x,ref:n})})})});V.displayName=w;var K="RadioGroupItem",z=t.forwardRef((o,n)=>{const{__scopeRadioGroup:s,disabled:c,...r}=o,i=ge(K,s),d=i.disabled||c,u=U(s),p=B(s),g=t.useRef(null),m=C(n,g),f=i.value===r.value,x=t.useRef(!1);return t.useEffect(()=>{const l=v=>{fe.includes(v.key)&&(x.current=!0)},a=()=>x.current=!1;return document.addEventListener("keydown",l),document.addEventListener("keyup",a),()=>{document.removeEventListener("keydown",l),document.removeEventListener("keyup",a)}},[]),e.jsx(Z,{asChild:!0,...u,focusable:!d,active:f,children:e.jsx(T,{disabled:d,required:i.required,checked:f,...p,...r,name:i.name,ref:m,onCheck:()=>i.onValueChange(r.value),onKeyDown:N(l=>{l.key==="Enter"&&l.preventDefault()}),onFocus:N(r.onFocus,()=>{x.current&&g.current?.click()})})})});z.displayName=K;var xe="RadioGroupIndicator",H=t.forwardRef((o,n)=>{const{__scopeRadioGroup:s,...c}=o,r=B(s);return e.jsx(q,{...r,...c,ref:n})});H.displayName=xe;var Y=V,$=z,ye=H;const J=t.forwardRef(({className:o,...n},s)=>e.jsx(Y,{className:F("grid gap-2",o),...n,ref:s}));J.displayName=Y.displayName;const S=t.forwardRef(({className:o,...n},s)=>e.jsx($,{ref:s,className:F("aspect-square h-4 w-4 rounded-full border border-primary text-primary ring-offset-background focus:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",o),...n,children:e.jsx(ye,{className:"flex items-center justify-center",children:e.jsx(ae,{className:"h-2.5 w-2.5 fill-current text-current"})})}));S.displayName=$.displayName;const Ce=()=>{const o=re(),{toast:n}=oe(),[s,c]=t.useState(!1),[r,i]=t.useState(""),[d,u]=t.useState(""),[p,g]=t.useState(""),[m,f]=t.useState("student"),x=async a=>{a.preventDefault(),c(!0);const{data:v,error:h}=await j.auth.signInWithPassword({email:r,password:d});if(h)n({title:"Error",description:h.message,variant:"destructive"});else if(v.user){await j.from("activity_logs").insert({user_id:v.user.id,action:"Signed in",details:{timestamp:new Date().toISOString()}});const{data:E}=await j.rpc("has_role",{_user_id:v.user.id,_role:"admin"});o(E?"/admin/dashboard":"/study-hall")}c(!1)},l=async a=>{a.preventDefault(),c(!0);const v=r.toLowerCase()==="admin@studyquest.com",{error:h}=await j.auth.signUp({email:r,password:d,options:{emailRedirectTo:`${window.location.origin}/study-hall`,data:{full_name:p,role:m}}});h?n({title:"Error",description:h.message,variant:"destructive"}):(n({title:"Success!",description:v?"Admin account created successfully! You can now sign in.":"Account created successfully. You can now sign in."}),o("/study-hall")),c(!1)};return e.jsx("div",{className:"min-h-screen flex items-center justify-center p-3 sm:p-4 bg-gradient-to-br from-background via-background to-surface-elevated",children:e.jsxs(ne,{className:"w-full max-w-md p-4 sm:p-6 md:p-8 bg-surface border-border/50",children:[e.jsx("div",{className:"flex justify-center mb-8",children:e.jsx(te,{})}),e.jsxs(ie,{defaultValue:"signin",className:"w-full",children:[e.jsxs(de,{className:"grid w-full grid-cols-2 mb-8",children:[e.jsx(P,{value:"signin",children:"Sign In"}),e.jsx(P,{value:"signup",children:"Sign Up"})]}),e.jsx(A,{value:"signin",children:e.jsxs("form",{onSubmit:x,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(y,{htmlFor:"email",children:"Email"}),e.jsx(R,{id:"email",type:"email",placeholder:"your@email.com",value:r,onChange:a=>i(a.target.value),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(y,{htmlFor:"password",children:"Password"}),e.jsx(R,{id:"password",type:"password",placeholder:"••••••••",value:d,onChange:a=>u(a.target.value),required:!0})]}),e.jsx(_,{type:"submit",className:"w-full",disabled:s,children:s?"Signing In...":"Sign In"})]})}),e.jsx(A,{value:"signup",children:e.jsxs("form",{onSubmit:l,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(y,{htmlFor:"fullname",children:"Full Name"}),e.jsx(R,{id:"fullname",type:"text",placeholder:"John Doe",value:p,onChange:a=>g(a.target.value),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(y,{htmlFor:"signup-email",children:"Email"}),e.jsx(R,{id:"signup-email",type:"email",placeholder:"your@email.com",value:r,onChange:a=>i(a.target.value),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(y,{htmlFor:"signup-password",children:"Password"}),e.jsx(R,{id:"signup-password",type:"password",placeholder:"••••••••",value:d,onChange:a=>u(a.target.value),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(y,{children:"I am a"}),e.jsxs(J,{value:m,onValueChange:a=>f(a),children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(S,{value:"student",id:"student"}),e.jsx(y,{htmlFor:"student",className:"cursor-pointer",children:"Student"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(S,{value:"professional",id:"professional"}),e.jsx(y,{htmlFor:"professional",className:"cursor-pointer",children:"Professional (Teacher/Instructor)"})]})]})]}),e.jsx(_,{type:"submit",className:"w-full",disabled:s,children:s?"Creating Account...":"Sign Up"})]})})]})]})})};export{Ce as default};
